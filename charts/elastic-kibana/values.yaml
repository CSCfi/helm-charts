## OpenShift Routes
# Enable OpenShift Routes for grafana and/or prometheus
route:
  kibana:
    enabled: true

  insecureEdgeTerminationPolicy: Redirect
  termination: edge 

## Elasticsearch configuration
elasticsearch:
  global:
    kibanaEnabled: true
    security:
      allowInsecureImages: true

  image:
    repository: bitnamilegacy/elasticsearch
    tag: 9.0.4

  security:
    enabled: true
    existingSecret: 'elasticsearch-password'
    tls:
      restEncryption: true
      autoGenerated: true

  master:
    masterOnly: true
    replicaCount: 2
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 300m
        memory: 1Gi
    persistence:
      enabled: true
      accessModes:
        - ReadWriteOnce
      size: 5Gi
  
  data:
    replicaCount: 1
    resources:
      requests:
        cpu: 100m
        memory: 1500Mi
      limits:
        cpu: 300m
        memory: 2Gi
    persistence:
      enabled: true
      accessModes:
        - ReadWriteOnce
      size: 5Gi

  coordinating:
    replicaCount: 1
    resources:
      requests:
        cpu: 100m
        memory: 512Mi
      limits:
        cpu: 300m
        memory: 1Gi

  ingest:
    replicaCount: 1
    resources:
      requests:
        cpu: 100m
        memory: 512Mi
      limits:
        cpu: 300m
        memory: 1Gi

  metrics:
    enabled: false
    image:
      repository: bitnamilegacy/elasticsearch-exporter
      tag: 1.9.0-debian-12-r15
    resources: {}

  sysctlImage:
    enabled: false
    image:
      repository: bitnamisecure/os-shell
      tag: latest
    resources: {}

  copyTlsCerts:
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 300m
        memory: 512Mi

  # Kibana configuration
  kibana:
    # image:
    #   repository: bitnamilegacy/kibana
    #   tag: 9.0.4-debian-12-r15

    elasticsearch:
      hosts:
        - '{{ include "elasticsearch.service.name" . }}'
      port: '{{ include "elasticsearch.service.ports.restAPI" . }}'
      
      security:
        auth:
          enabled: true
          existingSecret: 'kibana-password'
          createSystemUser: true
          elasticsearchPasswordSecret: 'elasticsearch-password'
        tls:
          enabled: true
          # You will need to know the name upfront of your release
          existingSecret: 'RELEASENAME-elasticsearch-coordinating-crt' # or just 'elasticsearch-coordinating-crt' if the release name happens to be 'elasticsearch'
          usePemCerts: true

    configuration:
      server:
        basePath: ""
        host: "0.0.0.0"
        publicBaseUrl: ""
        rewriteBasePath: false

    persistence:
      enabled: true
      accessModes:
        - ReadWriteOnce
      size: 8Gi

    resources:
      requests:
        cpu: 100m
        memory: 1Gi
      limits:
        cpu: 200m
        memory: 2Gi
